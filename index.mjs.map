{"version":3,"file":"index.mjs","sources":["../lib/benchmark-class/set_timeout.js","../lib/benchmark-class/clear_timeout.js","../lib/benchmark-class/run.js","../lib/benchmark-class/exit.js","../lib/benchmark-class/ended.js","../lib/benchmark-class/assert.js","../lib/benchmark-class/comment.js","../lib/benchmark-class/skip.js","../lib/benchmark-class/todo.js","../lib/benchmark-class/fail.js","../lib/benchmark-class/pass.js","../lib/benchmark-class/ok.js","../lib/benchmark-class/not_ok.js","../lib/benchmark-class/equal.js","../lib/benchmark-class/not_equal.js","../lib/benchmark-class/deep_equal.js","../lib/benchmark-class/not_deep_equal.js","../lib/utils/next_tick.js","../lib/benchmark-class/end.js","../lib/benchmark-class/index.js","../lib/runner/encode_assertion.js","../lib/runner/encode_result.js","../lib/runner/push.js","../lib/runner/create_stream.js","../lib/runner/run.js","../lib/runner/clear.js","../lib/runner/close.js","../lib/runner/exit.js","../lib/runner/index.js","../lib/harness/validate.js","../lib/harness/pretest.js","../lib/harness/iterations.js","../lib/harness/init.js","../lib/harness/index.js","../lib/utils/process.js","../lib/utils/can_exit.js","../lib/utils/can_emit_exit.js","../lib/log/log.js","../lib/log/index.js","../lib/exit_harness.js","../lib/get_harness.js","../lib/bench.js","../lib/index.js"],"sourcesContent":["/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// EXPORTS //\n\nmodule.exports = setTimeout;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// EXPORTS //\n\nmodule.exports = clearTimeout;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar timeout = require( './set_timeout.js' );\nvar clear = require( './clear_timeout.js' );\n\n\n// MAIN //\n\n/**\n* Runs a benchmark.\n*\n* @private\n* @returns {void}\n*/\nfunction run() {\n\t/* eslint-disable no-invalid-this */\n\tvar self;\n\tvar id;\n\tif ( this._skip ) {\n\t\tthis.comment( 'SKIP '+this.name );\n\t\treturn this.end();\n\t}\n\tif ( !this._benchmark ) {\n\t\tthis.comment( 'TODO '+this.name );\n\t\treturn this.end();\n\t}\n\tself = this;\n\tthis._running = true;\n\n\tid = timeout( onTimeout, this.timeout );\n\tthis.once( 'end', endTimeout );\n\n\tthis.emit( 'prerun' );\n\tthis._benchmark( this );\n\tthis.emit( 'run' );\n\n\t/**\n\t* Callback invoked once a timeout ends.\n\t*\n\t* @private\n\t*/\n\tfunction onTimeout() {\n\t\tself.fail( 'benchmark timed out after '+self.timeout+'ms' );\n\t}\n\n\t/**\n\t* Clears a timeout.\n\t*\n\t* @private\n\t*/\n\tfunction endTimeout() {\n\t\tclear( id );\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = run;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Forcefully ends a benchmark.\n*\n* @private\n* @returns {void}\n*/\nfunction exit() {\n\t/* eslint-disable no-invalid-this */\n\tif ( this._exited ) {\n\t\t// If we have already \"exited\", do not create more failing assertions when one should suffice...\n\t\treturn;\n\t}\n\t// Only \"exit\" when a benchmark has either not yet been run or is currently running. If a benchmark has already ended, no need to generate a failing assertion.\n\tif ( !this._ended ) {\n\t\tthis._exited = true;\n\t\tthis.fail( 'benchmark exited without ending' );\n\n\t\t// Allow running benchmarks to call `end` on their own...\n\t\tif ( !this._running ) {\n\t\t\tthis.end();\n\t\t}\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = exit;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Returns a `boolean` indicating if a benchmark has ended.\n*\n* @private\n* @returns {boolean} boolean indicating if a benchmark has ended\n*/\nfunction ended() {\n\t/* eslint-disable no-invalid-this */\n\treturn this._ended;\n}\n\n\n// EXPORTS //\n\nmodule.exports = ended;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\nvar format = require( '@stdlib/error-tools-fmtprodmsg' );\n\n// MODULES //\n\nvar hasOwnProp = require( '@stdlib/assert-has-own-property' );\n\n\n// MAIN //\n\n/**\n* Generates an assertion.\n*\n* @private\n* @param {boolean} ok - assertion outcome\n* @param {Options} opts - options\n*/\nfunction assert( ok, opts ) {\n\t/* eslint-disable no-invalid-this, no-unused-vars */ // TODO: remove no-unused-vars once `err` is used\n\tvar result;\n\tvar err;\n\n\tresult = {\n\t\t'id': this._count,\n\t\t'ok': ok,\n\t\t'skip': opts.skip,\n\t\t'todo': opts.todo,\n\t\t'name': opts.message || '(unnamed assert)',\n\t\t'operator': opts.operator\n\t};\n\tif ( hasOwnProp( opts, 'actual' ) ) {\n\t\tresult.actual = opts.actual;\n\t}\n\tif ( hasOwnProp( opts, 'expected' ) ) {\n\t\tresult.expected = opts.expected;\n\t}\n\tif ( !ok ) {\n\t\tresult.error = opts.error || new Error( this.name );\n\t\terr = new Error( format( '05d0C' ) );\n\n\t\t// TODO: generate an exception in order to locate the calling function (https://github.com/substack/tape/blob/master/lib/test.js#L215)\n\t}\n\tthis._count += 1;\n\tthis.emit( 'result', result );\n}\n\n\n// EXPORTS //\n\nmodule.exports = assert;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar trim = require( '@stdlib/string-trim' );\nvar replace = require( '@stdlib/string-replace' );\nvar EOL = require( '@stdlib/regexp-eol' ).REGEXP;\n\n\n// VARIABLES //\n\nvar RE_COMMENT = /^#\\s*/;\n\n\n// MAIN //\n\n/**\n* Writes a comment.\n*\n* @private\n* @param {string} msg - comment message\n*/\nfunction comment( msg ) {\n\t/* eslint-disable no-invalid-this */\n\tvar lines;\n\tvar i;\n\tmsg = trim( msg );\n\tlines = msg.split( EOL );\n\tfor ( i = 0; i < lines.length; i++ ) {\n\t\tmsg = trim( lines[ i ] );\n\t\tmsg = replace( msg, RE_COMMENT, '' );\n\t\tthis.emit( 'result', msg );\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = comment;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Generates an assertion which will be skipped.\n*\n* @private\n* @param {*} value - value\n* @param {string} msg - message\n*/\nfunction skip( value, msg ) {\n\t/* eslint-disable no-invalid-this */\n\tthis._assert( true, {\n\t\t'message': msg,\n\t\t'operator': 'skip',\n\t\t'skip': true\n\t});\n}\n\n\n// EXPORTS //\n\nmodule.exports = skip;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Generates an assertion which should be implemented.\n*\n* @private\n* @param {*} value - value\n* @param {string} msg - message\n*/\nfunction todo( value, msg ) {\n\t/* eslint-disable no-invalid-this */\n\tthis._assert( !!value, {\n\t\t'message': msg,\n\t\t'operator': 'todo',\n\t\t'todo': true\n\t});\n}\n\n\n// EXPORTS //\n\nmodule.exports = todo;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Generates a failing assertion.\n*\n* @private\n* @param {string} msg - message\n*/\nfunction fail( msg ) {\n\t/* eslint-disable no-invalid-this */\n\tthis._assert( false, {\n\t\t'message': msg,\n\t\t'operator': 'fail'\n\t});\n}\n\n\n// EXPORTS //\n\nmodule.exports = fail;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Generates a passing assertion.\n*\n* @private\n* @param {string} msg - message\n*/\nfunction pass( msg ) {\n\t/* eslint-disable no-invalid-this */\n\tthis._assert( true, {\n\t\t'message': msg,\n\t\t'operator': 'pass'\n\t});\n}\n\n\n// EXPORTS //\n\nmodule.exports = pass;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Asserts that a `value` is truthy.\n*\n* @private\n* @param {*} value - value\n* @param {string} [msg] - message\n*/\nfunction ok( value, msg ) {\n\t/* eslint-disable no-invalid-this */\n\tthis._assert( !!value, {\n\t\t'message': msg || 'should be truthy',\n\t\t'operator': 'ok',\n\t\t'expected': true,\n\t\t'actual': value\n\t});\n}\n\n\n// EXPORTS //\n\nmodule.exports = ok;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Asserts that a `value` is falsy.\n*\n* @private\n* @param {*} value - value\n* @param {string} [msg] - message\n*/\nfunction notOk( value, msg ) {\n\t/* eslint-disable no-invalid-this */\n\tthis._assert( !value, {\n\t\t'message': msg || 'should be falsy',\n\t\t'operator': 'notOk',\n\t\t'expected': false,\n\t\t'actual': value\n\t});\n}\n\n\n// EXPORTS //\n\nmodule.exports = notOk;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Asserts that `actual` is strictly equal to `expected`.\n*\n* @private\n* @param {*} actual - actual value\n* @param {*} expected - expected value\n* @param {string} [msg] - message\n*/\nfunction equal( actual, expected, msg ) {\n\t/* eslint-disable no-invalid-this */\n\tthis._assert( actual === expected, {\n\t\t'message': msg || 'should be equal',\n\t\t'operator': 'equal',\n\t\t'expected': expected,\n\t\t'actual': actual\n\t});\n}\n\n\n// EXPORTS //\n\nmodule.exports = equal;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Asserts that `actual` is not strictly equal to `expected`.\n*\n* @private\n* @param {*} actual - actual value\n* @param {*} expected - expected value\n* @param {string} [msg] - message\n*/\nfunction notEqual( actual, expected, msg ) {\n\t/* eslint-disable no-invalid-this */\n\tthis._assert( actual !== expected, {\n\t\t'message': msg || 'should not be equal',\n\t\t'operator': 'notEqual',\n\t\t'expected': expected,\n\t\t'actual': actual\n\t});\n}\n\n\n// EXPORTS //\n\nmodule.exports = notEqual;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Asserts that `actual` is deeply equal to `expected`.\n*\n* @private\n* @param {*} actual - actual value\n* @param {*} expected - expected value\n* @param {string} [msg] message\n*/\nfunction deepEqual( actual, expected, msg ) {\n\t/* eslint-disable no-invalid-this */\n\tthis.comment( 'actual: '+actual+'. expected: '+expected+'. msg: '+msg+'.' );\n\n\t// TODO: implement\n}\n\n\n// EXPORTS //\n\nmodule.exports = deepEqual;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Asserts that `actual` is not deeply equal to `expected`.\n*\n* @private\n* @param {*} actual - actual value\n* @param {*} expected - expected value\n* @param {string} [msg] message\n*/\nfunction notDeepEqual( actual, expected, msg ) {\n\t/* eslint-disable no-invalid-this */\n\tthis.comment( 'actual: '+actual+'. expected: '+expected+'. msg: '+msg+'.' );\n\n\t// TODO: implement\n}\n\n\n// EXPORTS //\n\nmodule.exports = notDeepEqual;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Runs a function on a subsequent turn of the event loop.\n*\n* ## Notes\n*\n* -   `process.nextTick` is only Node.js.\n* -   `setImmediate` is non-standard.\n* -   Everything else is browser based (e.g., mutation observer, requestAnimationFrame, etc).\n* -   Only API which is universal is `setTimeout`.\n* -   Note that `0` is not actually `0ms`. Browser environments commonly have a minimum delay of `4ms`. This is acceptable. Here, the main intent of this function is to give the runtime a chance to run garbage collection, clear state, and tend to any other pending tasks before returning control to benchmark tasks. The larger aim (attainable or not) is to provide each benchmark run with as much of a fresh state as possible.\n*\n*\n* @private\n* @param {Function} fcn - function to run upon a subsequent turn of the event loop\n*/\nfunction nextTick( fcn ) {\n\tsetTimeout( fcn, 0 );\n}\n\n\n// EXPORTS //\n\nmodule.exports = nextTick;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar nextTick = require( './../utils/next_tick.js' );\n\n\n// MAIN //\n\n/**\n* Ends a benchmark.\n*\n* @private\n*/\nfunction end() {\n\t/* eslint-disable no-invalid-this */\n\tvar self = this;\n\tif ( this._ended ) {\n\t\tthis.fail( '.end() called more than once' );\n\t} else {\n\t\t// Prevents releasing the zalgo when running synchronous benchmarks.\n\t\tnextTick( onTick );\n\t}\n\tthis._ended = true;\n\tthis._running = false;\n\n\t/**\n\t* Callback invoked upon a subsequent tick of the event loop.\n\t*\n\t* @private\n\t*/\n\tfunction onTick() {\n\t\tself.emit( 'end' );\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = end;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar EventEmitter = require( 'events' ).EventEmitter;\nvar inherit = require( '@stdlib/utils-inherit' );\nvar defineProperty = require( '@stdlib/utils-define-property' );\nvar setReadOnly = require( '@stdlib/utils-define-nonenumerable-read-only-property' );\nvar tic = require( '@stdlib/time-tic' );\nvar toc = require( '@stdlib/time-toc' );\nvar run = require( './run.js' );\nvar exit = require( './exit.js' );\nvar ended = require( './ended.js' );\nvar assert = require( './assert.js' );\nvar comment = require( './comment.js' );\nvar skip = require( './skip.js' );\nvar todo = require( './todo.js' );\nvar fail = require( './fail.js' );\nvar pass = require( './pass.js' );\nvar ok = require( './ok.js' );\nvar notOk = require( './not_ok.js' );\nvar equal = require( './equal.js' );\nvar notEqual = require( './not_equal.js' );\nvar deepEqual = require( './deep_equal.js' );\nvar notDeepEqual = require( './not_deep_equal.js' );\nvar end = require( './end.js' );\n\n\n// MAIN //\n\n/**\n* Benchmark constructor.\n*\n* @constructor\n* @param {string} name - benchmark name\n* @param {Options} opts - benchmark options\n* @param {boolean} opts.skip - boolean indicating whether to skip a benchmark\n* @param {PositiveInteger} opts.iterations - number of iterations\n* @param {PositiveInteger} opts.timeout - number of milliseconds before a benchmark automatically fails\n* @param {Function} [benchmark] - function containing benchmark code\n* @returns {Benchmark} Benchmark instance\n*\n* @example\n* var bench = new Benchmark( 'beep', function benchmark( b ) {\n*     var x;\n*     var i;\n*     b.comment( 'Running benchmarks...' );\n*     b.tic();\n*     for ( i = 0; i < b.iterations; i++ ) {\n*         x = Math.sin( Math.random() );\n*         if ( x !== x ) {\n*             b.ok( false, 'should not return NaN' );\n*         }\n*     }\n*     b.toc();\n*     if ( x !== x ) {\n*         b.ok( false, 'should not return NaN' );\n*     }\n*     b.comment( 'Finished running benchmarks.' );\n*     b.end();\n* });\n*/\nfunction Benchmark( name, opts, benchmark ) {\n\tvar hasTicked;\n\tvar hasTocked;\n\tvar self;\n\tvar time;\n\tif ( !( this instanceof Benchmark ) ) {\n\t\treturn new Benchmark( name, opts, benchmark );\n\t}\n\tself = this;\n\thasTicked = false;\n\thasTocked = false;\n\n\tEventEmitter.call( this );\n\n\t// Private properties:\n\tsetReadOnly( this, '_benchmark', benchmark );\n\tsetReadOnly( this, '_skip', opts.skip );\n\n\tdefineProperty( this, '_ended', {\n\t\t'configurable': false,\n\t\t'enumerable': false,\n\t\t'writable': true,\n\t\t'value': false\n\t});\n\n\tdefineProperty( this, '_running', {\n\t\t'configurable': false,\n\t\t'enumerable': false,\n\t\t'writable': true,\n\t\t'value': false\n\t});\n\n\tdefineProperty( this, '_exited', {\n\t\t'configurable': false,\n\t\t'enumerable': false,\n\t\t'writable': true,\n\t\t'value': false\n\t});\n\n\tdefineProperty( this, '_count', {\n\t\t'configurable': false,\n\t\t'enumerable': false,\n\t\t'writable': true,\n\t\t'value': 0\n\t});\n\n\t// Read-only:\n\tsetReadOnly( this, 'name', name );\n\tsetReadOnly( this, 'tic', start );\n\tsetReadOnly( this, 'toc', stop );\n\tsetReadOnly( this, 'iterations', opts.iterations );\n\tsetReadOnly( this, 'timeout', opts.timeout );\n\n\treturn this;\n\n\t/**\n\t* Starts a benchmark timer.\n\t*\n\t* ## Notes\n\t*\n\t* -   Using a scoped variable prevents nefarious mutation by bad actors hoping to manipulate benchmark results.\n\t* -   The one attack vector which remains is manipulation of the `require` cache for `tic` and `toc`.\n\t* -   One way to combat cache manipulation is by comparing the checksum of `Function#toString()` against known values.\n\t*\n\t* @private\n\t*/\n\tfunction start() {\n\t\tif ( hasTicked ) {\n\t\t\tself.fail( '.tic() called more than once' );\n\t\t} else {\n\t\t\tself.emit( 'tic' );\n\t\t\thasTicked = true;\n\t\t\ttime = tic();\n\t\t}\n\t}\n\n\t/**\n\t* Stops a benchmark timer.\n\t*\n\t* @private\n\t* @returns {void}\n\t*/\n\tfunction stop() {\n\t\tvar elapsed;\n\t\tvar secs;\n\t\tvar rate;\n\t\tvar out;\n\n\t\tif ( hasTicked === false ) {\n\t\t\treturn self.fail( '.toc() called before .tic()' );\n\t\t}\n\t\telapsed = toc( time );\n\t\tif ( hasTocked ) {\n\t\t\treturn self.fail( '.toc() called more than once' );\n\t\t}\n\t\thasTocked = true;\n\t\tself.emit( 'toc' );\n\n\t\tsecs = elapsed[ 0 ] + ( elapsed[ 1 ]/1e9 );\n\t\trate = self.iterations / secs;\n\n\t\tout = {\n\t\t\t'ok': true,\n\t\t\t'operator': 'result',\n\t\t\t'iterations': self.iterations,\n\t\t\t'elapsed': secs,\n\t\t\t'rate': rate\n\t\t};\n\t\tself.emit( 'result', out );\n\t}\n}\n\n/*\n* Inherit from the `EventEmitter` prototype.\n*/\ninherit( Benchmark, EventEmitter );\n\n/**\n* Runs a benchmark.\n*\n* @private\n* @name run\n* @memberof Benchmark.prototype\n* @type {Function}\n*/\nsetReadOnly( Benchmark.prototype, 'run', run );\n\n/**\n* Forcefully ends a benchmark.\n*\n* @private\n* @name exit\n* @memberof Benchmark.prototype\n* @type {Function}\n*/\nsetReadOnly( Benchmark.prototype, 'exit', exit );\n\n/**\n* Returns a `boolean` indicating if a benchmark has ended.\n*\n* @private\n* @name ended\n* @memberof Benchmark.prototype\n* @type {Function}\n* @returns {boolean} boolean indicating if a benchmark has ended\n*/\nsetReadOnly( Benchmark.prototype, 'ended', ended );\n\n/**\n* Generates an assertion.\n*\n* @private\n* @name _assert\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {boolean} ok - assertion outcome\n* @param {Options} opts - options\n*/\nsetReadOnly( Benchmark.prototype, '_assert', assert );\n\n/**\n* Writes a comment.\n*\n* @name comment\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {string} msg - comment message\n*/\nsetReadOnly( Benchmark.prototype, 'comment', comment );\n\n/**\n* Generates an assertion which will be skipped.\n*\n* @name skip\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {*} value - value\n* @param {string} msg - message\n*/\nsetReadOnly( Benchmark.prototype, 'skip', skip );\n\n/**\n* Generates an assertion which should be implemented.\n*\n* @name todo\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {*} value - value\n* @param {string} msg - message\n*/\nsetReadOnly( Benchmark.prototype, 'todo', todo );\n\n/**\n* Generates a failing assertion.\n*\n* @name fail\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {string} msg - message\n*/\nsetReadOnly( Benchmark.prototype, 'fail', fail );\n\n/**\n* Generates a passing assertion.\n*\n* @name pass\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {string} msg - message\n*/\nsetReadOnly( Benchmark.prototype, 'pass', pass );\n\n/**\n* Asserts that a `value` is truthy.\n*\n* @name ok\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {*} value - value\n* @param {string} [msg] - message\n*/\nsetReadOnly( Benchmark.prototype, 'ok', ok );\n\n/**\n* Asserts that a `value` is falsy.\n*\n* @name notOk\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {*} value - value\n* @param {string} [msg] - message\n*/\nsetReadOnly( Benchmark.prototype, 'notOk', notOk );\n\n/**\n* Asserts that `actual` is strictly equal to `expected`.\n*\n* @name equal\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {*} actual - actual value\n* @param {*} expected - expected value\n* @param {string} [msg] - message\n*/\nsetReadOnly( Benchmark.prototype, 'equal', equal );\n\n/**\n* Asserts that `actual` is not strictly equal to `expected`.\n*\n* @name notEqual\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {*} actual - actual value\n* @param {*} expected - expected value\n* @param {string} [msg] - message\n*/\nsetReadOnly( Benchmark.prototype, 'notEqual', notEqual );\n\n/**\n* Asserts that `actual` is deeply equal to `expected`.\n*\n* @name deepEqual\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {*} actual - actual value\n* @param {*} expected - expected value\n* @param {string} [msg] message\n*/\nsetReadOnly( Benchmark.prototype, 'deepEqual', deepEqual );\n\n/**\n* Asserts that `actual` is not deeply equal to `expected`.\n*\n* @name notDeepEqual\n* @memberof Benchmark.prototype\n* @type {Function}\n* @param {*} actual - actual value\n* @param {*} expected - expected value\n* @param {string} [msg] message\n*/\nsetReadOnly( Benchmark.prototype, 'notDeepEqual', notDeepEqual );\n\n/**\n* Ends a benchmark.\n*\n* @name end\n* @memberof Benchmark.prototype\n* @type {Function}\n*/\nsetReadOnly( Benchmark.prototype, 'end', end );\n\n\n// EXPORTS //\n\nmodule.exports = Benchmark;\n","/* eslint-disable stdlib/jsdoc-require-throws-tags */\n\n/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar replace = require( '@stdlib/string-replace' );\nvar hasOwnProp = require( '@stdlib/assert-has-own-property' );\nvar RE_EOL = require( '@stdlib/regexp-eol' ).REGEXP;\n\n\n// VARIABLES //\n\nvar RE_WHITESPACE = /\\s+/g;\n\n\n// MAIN //\n\n/**\n* Encodes an assertion.\n*\n* @private\n* @param {Object} result - result\n* @param {PositiveInteger} count - result count\n* @returns {string} encoded assertion\n*/\nfunction encodeAssertion( result, count ) {\n\tvar actualStack;\n\tvar errorStack;\n\tvar expected;\n\tvar actual;\n\tvar indent;\n\tvar stack;\n\tvar lines;\n\tvar out;\n\tvar i;\n\n\tout = '';\n\n\tif ( !result.ok ) {\n\t\tout += 'not ';\n\t}\n\t// Add result count:\n\tout += 'ok ' + count;\n\n\t// Add description:\n\tif ( result.name ) {\n\t\tout += ' ' + replace( result.name.toString(), RE_WHITESPACE, ' ' );\n\t}\n\t// Append directives:\n\tif ( result.skip ) {\n\t\tout += ' # SKIP';\n\t} else if ( result.todo ) {\n\t\tout += ' # TODO';\n\t}\n\tout += '\\n';\n\tif ( result.ok ) {\n\t\treturn out;\n\t}\n\t// Format diagnostics as YAML...\n\tindent = '  ';\n\tout += indent + '---\\n';\n\tout += indent + 'operator: ' + result.operator + '\\n';\n\tif (\n\t\thasOwnProp( result, 'actual' ) ||\n\t\thasOwnProp( result, 'expected' )\n\t) {\n\t\t// TODO: inspect object logic (https://github.com/substack/tape/blob/master/lib/results.js#L145)\n\t\texpected = result.expected;\n\t\tactual = result.actual;\n\t\tif ( actual !== actual && expected !== expected ) {\n\t\t\tthrow new Error( 'unexpected error.' ); // TODO: remove me\n\t\t}\n\t}\n\tif ( result.at ) {\n\t\tout += indent + 'at: ' + result.at + '\\n';\n\t}\n\tif ( result.actual ) {\n\t\tactualStack = result.actual.stack;\n\t}\n\tif ( result.error ) {\n\t\terrorStack = result.error.stack;\n\t}\n\tif ( actualStack ) {\n\t\tstack = actualStack;\n\t} else {\n\t\tstack = errorStack;\n\t}\n\tif ( stack ) {\n\t\tlines = stack.toString().split( RE_EOL );\n\t\tout += indent + 'stack: |-\\n';\n\t\tfor ( i = 0; i < lines.length; i++ ) {\n\t\t\tout += indent + '  ' + lines[ i ] + '\\n';\n\t\t}\n\t}\n\tout += indent + '...\\n';\n\treturn out;\n}\n\n\n// EXPORTS //\n\nmodule.exports = encodeAssertion;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// VARIABLES //\n\nvar YAML_INDENT = '  ';\nvar YAML_BEGIN = YAML_INDENT + '---\\n';\nvar YAML_END = YAML_INDENT + '...\\n';\n\n\n// MAIN //\n\n/**\n* Encodes a result as a YAML block.\n*\n* @private\n* @param {Object} result - result\n* @returns {string} encoded result\n*/\nfunction encodeResult( result ) {\n\tvar out = YAML_BEGIN;\n\tout += YAML_INDENT + 'iterations: '+result.iterations+'\\n';\n\tout += YAML_INDENT + 'elapsed: '+result.elapsed+'\\n';\n\tout += YAML_INDENT + 'rate: '+result.rate+'\\n';\n\tout += YAML_END;\n\treturn out;\n}\n\n\n// EXPORTS //\n\nmodule.exports = encodeResult;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n/* eslint-disable no-underscore-dangle */\n\n'use strict';\n\n// MODULES //\n\nvar isString = require( '@stdlib/assert-is-string' ).isPrimitive;\nvar encodeAssertion = require( './encode_assertion.js' );\nvar encodeResult = require( './encode_result.js' );\n\n\n// MAIN //\n\n/**\n* Adds a new benchmark.\n*\n* @private\n* @param {Benchmark} b - benchmark\n*/\nfunction push( b ) {\n\t/* eslint-disable no-invalid-this */\n\tvar self = this;\n\n\tthis._benchmarks.push( b );\n\n\tb.once( 'prerun', onPreRun );\n\tb.on( 'result', onResult );\n\n\tthis.emit( '_push', b );\n\n\t/**\n\t* Callback invoked upon a `prerun` event.\n\t*\n\t* @private\n\t*/\n\tfunction onPreRun() {\n\t\tself._stream.write( '# '+b.name+'\\n' );\n\t}\n\n\t/**\n\t* Callback invoked upon a `result` event.\n\t*\n\t* @private\n\t* @param {(Object|string)} res - result\n\t* @returns {void}\n\t*/\n\tfunction onResult( res ) {\n\t\t// Check for a comment...\n\t\tif ( isString( res ) ) {\n\t\t\treturn self._stream.write( '# '+res+'\\n' );\n\t\t}\n\t\tif ( res.operator === 'result' ) {\n\t\t\tres = encodeResult( res );\n\t\t\treturn self._stream.write( res );\n\t\t}\n\t\tself.total += 1;\n\t\tif ( res.ok ) {\n\t\t\tif ( res.skip ) {\n\t\t\t\tself.skip += 1;\n\t\t\t} else if ( res.todo ) {\n\t\t\t\tself.todo += 1;\n\t\t\t}\n\t\t\tself.pass += 1;\n\t\t}\n\t\t// According to the TAP spec, todos pass even if not \"ok\"...\n\t\telse if ( res.todo ) {\n\t\t\tself.pass += 1;\n\t\t\tself.todo += 1;\n\t\t}\n\t\t// Everything else is a failure...\n\t\telse {\n\t\t\tself.fail += 1;\n\t\t}\n\t\tres = encodeAssertion( res, self.total );\n\t\tself._stream.write( res );\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = push;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n/* eslint-disable no-underscore-dangle */\n\n'use strict';\n\n// MODULES //\n\nvar TransformStream = require( '@stdlib/streams-node-transform' );\nvar isString = require( '@stdlib/assert-is-string' ).isPrimitive;\nvar nextTick = require( './../utils/next_tick.js' );\n\n\n// VARIABLES //\n\nvar TAP_HEADER = 'TAP version 13';\n\n\n// MAIN //\n\n/**\n* Creates a results stream.\n*\n* @private\n* @param {Options} [options] - stream options\n* @throws {TypeError} options argument must be an object\n* @throws {TypeError} must provide valid options\n* @returns {TransformStream} transform stream\n*/\nfunction createStream( options ) {\n\t/* eslint-disable no-invalid-this */\n\tvar stream;\n\tvar opts;\n\tvar self;\n\tvar id;\n\n\tself = this;\n\tif ( arguments.length ) {\n\t\topts = options;\n\t} else {\n\t\topts = {};\n\t}\n\tstream = new TransformStream( opts );\n\tif ( opts.objectMode ) {\n\t\tid = 0;\n\t\tthis.on( '_push', onPush );\n\t\tthis.on( 'done', onDone );\n\t} else {\n\t\tstream.write( TAP_HEADER+'\\n' );\n\t\tthis._stream.pipe( stream );\n\t}\n\tthis.on( '_run', onRun );\n\treturn stream;\n\n\t/**\n\t* Runs the next benchmark.\n\t*\n\t* @private\n\t*/\n\tfunction next() {\n\t\tnextTick( onTick );\n\t}\n\n\t/**\n\t* Callback invoked upon the next tick.\n\t*\n\t* @private\n\t* @returns {void}\n\t*/\n\tfunction onTick() {\n\t\tvar b = self._benchmarks.shift();\n\t\tif ( b ) {\n\t\t\tb.run();\n\t\t\tif ( !b.ended() ) {\n\t\t\t\treturn b.once( 'end', next );\n\t\t\t}\n\t\t\treturn next();\n\t\t}\n\t\tself._running = false;\n\t\tself.emit( 'done' );\n\t}\n\n\t/**\n\t* Callback invoked upon a run event.\n\t*\n\t* @private\n\t* @returns {void}\n\t*/\n\tfunction onRun() {\n\t\tif ( !self._running ) {\n\t\t\tself._running = true;\n\t\t\treturn next();\n\t\t}\n\t}\n\n\t/**\n\t* Callback invoked upon a push event.\n\t*\n\t* @private\n\t* @param {Benchmark} b - benchmark\n\t*/\n\tfunction onPush( b ) {\n\t\tvar bid = id;\n\t\tid += 1;\n\n\t\tb.once( 'prerun', onPreRun );\n\t\tb.on( 'result', onResult );\n\t\tb.on( 'end', onEnd );\n\n\t\t/**\n\t\t* Callback invoked upon a `prerun` event.\n\t\t*\n\t\t* @private\n\t\t*/\n\t\tfunction onPreRun() {\n\t\t\tvar row = {\n\t\t\t\t'type': 'benchmark',\n\t\t\t\t'name': b.name,\n\t\t\t\t'id': bid\n\t\t\t};\n\t\t\tstream.write( row );\n\t\t}\n\n\t\t/**\n\t\t* Callback invoked upon a `result` event.\n\t\t*\n\t\t* @private\n\t\t* @param {(Object|string)} res - result\n\t\t*/\n\t\tfunction onResult( res ) {\n\t\t\tif ( isString( res ) ) {\n\t\t\t\tres = {\n\t\t\t\t\t'benchmark': bid,\n\t\t\t\t\t'type': 'comment',\n\t\t\t\t\t'name': res\n\t\t\t\t};\n\t\t\t} else if ( res.operator === 'result' ) {\n\t\t\t\tres.benchmark = bid;\n\t\t\t\tres.type = 'result';\n\t\t\t} else {\n\t\t\t\tres.benchmark = bid;\n\t\t\t\tres.type = 'assert';\n\t\t\t}\n\t\t\tstream.write( res );\n\t\t}\n\n\t\t/**\n\t\t* Callback invoked upon an `end` event.\n\t\t*\n\t\t* @private\n\t\t*/\n\t\tfunction onEnd() {\n\t\t\tstream.write({\n\t\t\t\t'benchmark': bid,\n\t\t\t\t'type': 'end'\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t* Callback invoked upon a `done` event.\n\t*\n\t* @private\n\t*/\n\tfunction onDone() {\n\t\tstream.destroy();\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = createStream;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Runs pending benchmarks.\n*\n* @private\n*/\nfunction run() {\n\t/* eslint-disable no-invalid-this */\n\tthis.emit( '_run' );\n}\n\n\n// EXPORTS //\n\nmodule.exports = run;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Removes any pending benchmarks.\n*\n* @private\n*/\nfunction clear() {\n\t/* eslint-disable no-invalid-this */\n\tthis._benchmarks.length = 0;\n}\n\n\n// EXPORTS //\n\nmodule.exports = clear;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Closes a benchmark runner.\n*\n* @private\n* @returns {void}\n*/\nfunction closeRunner() {\n\t/* eslint-disable no-invalid-this */\n\tvar self = this;\n\tif ( this._closed ) {\n\t\treturn;\n\t}\n\tthis._closed = true;\n\tif ( this._benchmarks.length ) {\n\t\tthis.clear();\n\t\tthis._stream.write( '# WARNING: harness closed before completion.\\n' );\n\t} else {\n\t\tthis._stream.write( '#\\n' );\n\t\tthis._stream.write( '1..'+this.total+'\\n' );\n\t\tthis._stream.write( '# total '+this.total+'\\n' );\n\t\tthis._stream.write( '# pass  '+this.pass+'\\n' );\n\t\tif ( this.fail ) {\n\t\t\tthis._stream.write( '# fail  '+this.fail+'\\n' );\n\t\t}\n\t\tif ( this.skip ) {\n\t\t\tthis._stream.write( '# skip  '+this.skip+'\\n' );\n\t\t}\n\t\tif ( this.todo ) {\n\t\t\tthis._stream.write( '# todo  '+this.todo+'\\n' );\n\t\t}\n\t\tif ( !this.fail ) {\n\t\t\tthis._stream.write( '#\\n# ok\\n' );\n\t\t}\n\t}\n\tthis._stream.once( 'close', onClose );\n\tthis._stream.destroy();\n\n\t/**\n\t* Callback invoked upon a `close` event.\n\t*\n\t* @private\n\t*/\n\tfunction onClose() {\n\t\tself.emit( 'close' );\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = closeRunner;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Forcefully exits a benchmark runner.\n*\n* @private\n*/\nfunction exit() {\n\t/* eslint-disable no-invalid-this */\n\tvar self;\n\tvar i;\n\tfor ( i = 0; i < this._benchmarks.length; i++ ) {\n\t\tthis._benchmarks[ i ].exit();\n\t}\n\tself = this;\n\tthis.clear();\n\tthis._stream.once( 'close', onClose );\n\tthis._stream.destroy();\n\n\t/**\n\t* Callback invoked upon a `close` event.\n\t*\n\t* @private\n\t*/\n\tfunction onClose() {\n\t\tself.emit( 'close' );\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = exit;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar EventEmitter = require( 'events' ).EventEmitter;\nvar inherit = require( '@stdlib/utils-inherit' );\nvar defineProperty = require( '@stdlib/utils-define-property' );\nvar TransformStream = require( '@stdlib/streams-node-transform' );\nvar push = require( './push.js' );\nvar createStream = require( './create_stream.js' );\nvar run = require( './run.js' );\nvar clear = require( './clear.js' );\nvar close = require( './close.js' ); // eslint-disable-line stdlib/no-redeclare\nvar exit = require( './exit.js' );\n\n\n// MAIN //\n\n/**\n* Benchmark runner.\n*\n* @private\n* @constructor\n* @returns {Runner} Runner instance\n*\n* @example\n* var runner = new Runner();\n*/\nfunction Runner() {\n\tif ( !( this instanceof Runner ) ) {\n\t\treturn new Runner();\n\t}\n\tEventEmitter.call( this );\n\n\t// Private properties:\n\tdefineProperty( this, '_benchmarks', {\n\t\t'value': [],\n\t\t'configurable': false,\n\t\t'writable': false,\n\t\t'enumerable': false\n\t});\n\n\tdefineProperty( this, '_stream', {\n\t\t'value': new TransformStream(),\n\t\t'configurable': false,\n\t\t'writable': false,\n\t\t'enumerable': false\n\t});\n\n\tdefineProperty( this, '_closed', {\n\t\t'value': false,\n\t\t'configurable': false,\n\t\t'writable': true,\n\t\t'enumerable': false\n\t});\n\n\tdefineProperty( this, '_running', {\n\t\t'value': false,\n\t\t'configurable': false,\n\t\t'writable': true,\n\t\t'enumerable': false\n\t});\n\n\t// Public properties:\n\tdefineProperty( this, 'total', {\n\t\t'value': 0,\n\t\t'configurable': false,\n\t\t'writable': true,\n\t\t'enumerable': true\n\t});\n\n\tdefineProperty( this, 'fail', {\n\t\t'value': 0,\n\t\t'configurable': false,\n\t\t'writable': true,\n\t\t'enumerable': true\n\t});\n\n\tdefineProperty( this, 'pass', {\n\t\t'value': 0,\n\t\t'configurable': false,\n\t\t'writable': true,\n\t\t'enumerable': true\n\t});\n\n\tdefineProperty( this, 'skip', {\n\t\t'value': 0,\n\t\t'configurable': false,\n\t\t'writable': true,\n\t\t'enumerable': true\n\t});\n\n\tdefineProperty( this, 'todo', {\n\t\t'value': 0,\n\t\t'configurable': false,\n\t\t'writable': true,\n\t\t'enumerable': true\n\t});\n\n\treturn this;\n}\n\n/*\n* Inherit from the `EventEmitter` prototype.\n*/\ninherit( Runner, EventEmitter );\n\n/**\n* Adds a new benchmark.\n*\n* @private\n* @memberof Runner.prototype\n* @function push\n* @param {Benchmark} b - benchmark\n*/\ndefineProperty( Runner.prototype, 'push', {\n\t'value': push,\n\t'configurable': false,\n\t'writable': false,\n\t'enumerable': false\n});\n\n/**\n* Creates a results stream.\n*\n* @private\n* @memberof Runner.prototype\n* @function createStream\n* @param {Options} [options] - stream options\n* @returns {TransformStream} transform stream\n*/\ndefineProperty( Runner.prototype, 'createStream', {\n\t'value': createStream,\n\t'configurable': false,\n\t'writable': false,\n\t'enumerable': false\n});\n\n/**\n* Runs pending benchmarks.\n*\n* @private\n* @memberof Runner.prototype\n* @function run\n*/\ndefineProperty( Runner.prototype, 'run', {\n\t'value': run,\n\t'configurable': false,\n\t'writable': false,\n\t'enumerable': false\n});\n\n/**\n* Removes any pending benchmarks.\n*\n* @private\n* @memberof Runner.prototype\n* @function clear\n*/\ndefineProperty( Runner.prototype, 'clear', {\n\t'value': clear,\n\t'configurable': false,\n\t'writable': false,\n\t'enumerable': false\n});\n\n/**\n* Closes a benchmark runner.\n*\n* @private\n* @memberof Runner.prototype\n* @function close\n*/\ndefineProperty( Runner.prototype, 'close', {\n\t'value': close,\n\t'configurable': false,\n\t'writable': false,\n\t'enumerable': false\n});\n\n/**\n* Forcefully exits a benchmark runner.\n*\n* @private\n* @memberof Runner.prototype\n* @function exit\n*/\ndefineProperty( Runner.prototype, 'exit', {\n\t'value': exit,\n\t'configurable': false,\n\t'writable': false,\n\t'enumerable': false\n});\n\n\n// EXPORTS //\n\nmodule.exports = Runner;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar isObject = require( '@stdlib/assert-is-plain-object' );\nvar hasOwnProp = require( '@stdlib/assert-has-own-property' );\nvar isBoolean = require( '@stdlib/assert-is-boolean' ).isPrimitive;\nvar isNull = require( '@stdlib/assert-is-null' );\nvar isPositiveInteger = require( '@stdlib/assert-is-positive-integer' ).isPrimitive;\nvar format = require( '@stdlib/error-tools-fmtprodmsg' );\n\n\n// MAIN //\n\n/**\n* Validates function options.\n*\n* @private\n* @param {Object} opts - destination object\n* @param {Options} options - function options\n* @param {boolean} [options.skip] - boolean indicating whether to skip a benchmark\n* @param {(PositiveInteger|null)} [options.iterations] - number of iterations\n* @param {PositiveInteger} [options.repeats] - number of repeats\n* @param {PositiveInteger} [options.timeout] - number of milliseconds before a benchmark automatically fails\n* @returns {(Error|null)} error object or null\n*\n* @example\n* var opts = {};\n* var options = {\n*     'skip': false,\n*     'iterations': 1e6,\n*     'repeats': 3,\n*     'timeout': 10000\n* };\n*\n* var err = validate( opts, options );\n* if ( err ) {\n*    throw err;\n* }\n*/\nfunction validate( opts, options ) {\n\tif ( !isObject( options ) ) {\n\t\treturn new TypeError( format( '05d2h', options ) );\n\t}\n\tif ( hasOwnProp( options, 'skip' ) ) {\n\t\topts.skip = options.skip;\n\t\tif ( !isBoolean( opts.skip ) ) {\n\t\t\treturn new TypeError( format( '05d30', 'skip', opts.skip ) );\n\t\t}\n\t}\n\tif ( hasOwnProp( options, 'iterations' ) ) {\n\t\topts.iterations = options.iterations;\n\t\tif (\n\t\t\t!isPositiveInteger( opts.iterations ) &&\n\t\t\t!isNull( opts.iterations )\n\t\t) {\n\t\t\treturn new TypeError( format( '05d8Z', 'iterations', opts.iterations ) );\n\t\t}\n\t}\n\tif ( hasOwnProp( options, 'repeats' ) ) {\n\t\topts.repeats = options.repeats;\n\t\tif ( !isPositiveInteger( opts.repeats ) ) {\n\t\t\treturn new TypeError( format( '05d3b', 'repeats', opts.repeats ) );\n\t\t}\n\t}\n\tif ( hasOwnProp( options, 'timeout' ) ) {\n\t\topts.timeout = options.timeout;\n\t\tif ( !isPositiveInteger( opts.timeout ) ) {\n\t\t\treturn new TypeError( format( '05d3b', 'timeout', opts.timeout ) );\n\t\t}\n\t}\n\treturn null;\n}\n\n\n// EXPORTS //\n\nmodule.exports = validate;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar isString = require( '@stdlib/assert-is-string' ).isPrimitive;\nvar copy = require( '@stdlib/utils-copy' );\nvar Benchmark = require( './../benchmark-class' );\n\n\n// MAIN //\n\n/**\n* Runs pretests to sanity check and/or catch failures.\n*\n* @private\n* @param {string} name - benchmark name\n* @param {Options} options - benchmark options\n* @param {(Function|undefined)} benchmark - function containing benchmark code\n* @param {Callback} clbk - callback to invoke after completing pretests\n*/\nfunction pretest( name, options, benchmark, clbk ) {\n\tvar fail;\n\tvar opts;\n\tvar tic;\n\tvar toc;\n\tvar b;\n\n\t// Counters to determine the number of `tic` and `toc` events:\n\ttic = 0;\n\ttoc = 0;\n\n\t// Local copy:\n\topts = copy( options );\n\topts.iterations = 1;\n\n\t// Pretest to check for minimum requirements and/or errors...\n\tb = new Benchmark( name, opts, benchmark );\n\tb.on( 'result', onResult );\n\tb.on( 'tic', onTic );\n\tb.on( 'toc', onToc );\n\tb.once( 'end', onEnd );\n\tb.run();\n\n\t/**\n\t* Callback invoked upon a `result` event.\n\t*\n\t* @private\n\t* @param {(string|Object)} result - result\n\t*/\n\tfunction onResult( result ) {\n\t\tif (\n\t\t\t!isString( result ) &&\n\t\t\t!result.ok &&\n\t\t\t!result.todo\n\t\t) {\n\t\t\tfail = true;\n\t\t}\n\t}\n\n\t/**\n\t* Callback invoked upon a `tic` event.\n\t*\n\t* @private\n\t*/\n\tfunction onTic() {\n\t\ttic += 1;\n\t}\n\n\t/**\n\t* Callback invoked upon a `toc` event.\n\t*\n\t* @private\n\t*/\n\tfunction onToc() {\n\t\ttoc += 1;\n\t}\n\n\t/**\n\t* Callback invoked upon an `end` event.\n\t*\n\t* @private\n\t* @returns {void}\n\t*/\n\tfunction onEnd() {\n\t\tvar err;\n\t\tif ( fail ) {\n\t\t\t// Possibility that failure is intermittent, but we will assume that the usual case is that the failure would persist across all repeats and no sense failing multiple times when once suffices.\n\t\t\terr = new Error( 'unexpected error. Benchmark failed.' );\n\t\t} else if ( tic !== 1 || toc !== 1 ) {\n\t\t\t// Unable to do anything definitive with timing information (e.g., a tic with no toc or vice versa, or benchmark function calls neither tic nor toc).\n\t\t\terr = new Error( 'unexpected error. Invalid benchmark.' );\n\t\t}\n\t\tif ( err ) {\n\t\t\treturn clbk( err );\n\t\t}\n\t\treturn clbk();\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = pretest;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar isString = require( '@stdlib/assert-is-string' ).isPrimitive;\nvar copy = require( '@stdlib/utils-copy' );\nvar Benchmark = require( './../benchmark-class' );\n\n\n// VARIABLES //\n\nvar MIN_TIME = 0.1; // seconds\nvar ITERATIONS = 10; // 10^1\nvar MAX_ITERATIONS = 10000000000; // 10^10\n\n\n// MAIN //\n\n/**\n* Determines the number of iterations.\n*\n* @private\n* @param {string} name - benchmark name\n* @param {Options} options - benchmark options\n* @param {(Function|undefined)} benchmark - function containing benchmark code\n* @param {Callback} clbk - callback to invoke after determining number of iterations\n* @returns {void}\n*/\nfunction iterations( name, options, benchmark, clbk ) {\n\tvar opts;\n\tvar time;\n\n\t// Elapsed time (in seconds):\n\ttime = 0;\n\n\t// Create a local copy:\n\topts = copy( options );\n\topts.iterations = ITERATIONS;\n\n\t// Begin running benchmarks:\n\treturn next();\n\n\t/**\n\t* Run a new benchmark.\n\t*\n\t* @private\n\t*/\n\tfunction next() {\n\t\tvar b = new Benchmark( name, opts, benchmark );\n\t\tb.on( 'result', onResult );\n\t\tb.once( 'end', onEnd );\n\t\tb.run();\n\t}\n\n\t/**\n\t* Callback invoked upon a `result` event.\n\t*\n\t* @private\n\t* @param {(string|Object)} result - result\n\t*/\n\tfunction onResult( result ) {\n\t\tif ( !isString( result ) && result.operator === 'result' ) {\n\t\t\ttime = result.elapsed;\n\t\t}\n\t}\n\n\t/**\n\t* Callback invoked upon an `end` event.\n\t*\n\t* @private\n\t* @returns {void}\n\t*/\n\tfunction onEnd() {\n\t\tif (\n\t\t\ttime < MIN_TIME &&\n\t\t\topts.iterations < MAX_ITERATIONS\n\t\t) {\n\t\t\topts.iterations *= 10;\n\t\t\treturn next();\n\t\t}\n\t\tclbk( null, opts.iterations );\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = iterations;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar pretest = require( './pretest.js' );\nvar iterations = require( './iterations.js' );\n\n\n// MAIN //\n\n/**\n* Performs benchmark initialization tasks.\n*\n* @private\n* @param {string} name - benchmark name\n* @param {Options} opts - benchmark options\n* @param {(Function|undefined)} benchmark - function containing benchmark code\n* @param {Callback} clbk - callback to invoke after completing initialization tasks\n* @returns {void}\n*/\nfunction init( name, opts, benchmark, clbk ) {\n\t// If no benchmark function, then the benchmark is considered a \"todo\", so no need to repeat multiple times...\n\tif ( !benchmark ) {\n\t\topts.repeats = 1;\n\t\treturn clbk( name, opts, benchmark );\n\t}\n\t// If the `skip` option to `true`, no need to initialize or repeat multiple times as will not be running the benchmark:\n\tif ( opts.skip ) {\n\t\topts.repeats = 1;\n\t\treturn clbk( name, opts, benchmark );\n\t}\n\t// Perform pretests:\n\tpretest( name, opts, benchmark, onPreTest );\n\n\t/**\n\t* Callback invoked upon completing pretests.\n\t*\n\t* @private\n\t* @param {Error} [error] - error object\n\t* @returns {void}\n\t*/\n\tfunction onPreTest( error ) {\n\t\t// If the pretests failed, don't run the benchmark multiple times...\n\t\tif ( error ) {\n\t\t\topts.repeats = 1;\n\t\t\topts.iterations = 1;\n\t\t\treturn clbk( name, opts, benchmark );\n\t\t}\n\t\t// If a user specified an iteration number, we can begin running benchmarks...\n\t\tif ( opts.iterations ) {\n\t\t\treturn clbk( name, opts, benchmark );\n\t\t}\n\t\t// Determine iteration number:\n\t\titerations( name, opts, benchmark, onIterations );\n\t}\n\n\t/**\n\t* Callback invoked upon determining an iteration number.\n\t*\n\t* @private\n\t* @param {(Error|null)} error - error object\n\t* @param {PositiveInteger} iter - number of iterations\n\t* @returns {void}\n\t*/\n\tfunction onIterations( error, iter ) {\n\t\t// If provided an error, then a benchmark failed, and, similar to pretests, don't run the benchmark multiple times...\n\t\tif ( error ) {\n\t\t\topts.repeats = 1;\n\t\t\topts.iterations = 1;\n\t\t\treturn clbk( name, opts, benchmark );\n\t\t}\n\t\topts.iterations = iter;\n\t\treturn clbk( name, opts, benchmark );\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = init;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar setReadOnly = require( '@stdlib/utils-define-nonenumerable-read-only-property' );\nvar setReadOnlyAccessor = require( '@stdlib/utils-define-nonenumerable-read-only-accessor' );\nvar isString = require( '@stdlib/assert-is-string' ).isPrimitive;\nvar isFunction = require( '@stdlib/assert-is-function' );\nvar isBoolean = require( '@stdlib/assert-is-boolean' ).isPrimitive;\nvar isObject = require( '@stdlib/assert-is-plain-object' );\nvar hasOwnProp = require( '@stdlib/assert-has-own-property' );\nvar format = require( '@stdlib/error-tools-fmtprodmsg' );\nvar copy = require( '@stdlib/utils-copy' );\nvar Benchmark = require( './../benchmark-class' );\nvar Runner = require( './../runner' );\nvar nextTick = require( './../utils/next_tick.js' );\nvar DEFAULTS = require( './../defaults.json' );\nvar validate = require( './validate.js' );\nvar init = require( './init.js' );\n\n\n// MAIN //\n\n/**\n* Creates a benchmark harness.\n*\n* @param {Options} [options] - function options\n* @param {boolean} [options.autoclose] - boolean indicating whether to automatically close a harness after a harness finishes running all benchmarks\n* @param {Callback} [clbk] - callback to invoke when a harness finishes running all benchmarks\n* @throws {TypeError} options argument must be an object\n* @throws {TypeError} must provide valid options\n* @throws {TypeError} callback argument must be a function\n* @returns {Function} benchmark harness\n*\n* @example\n* var bench = createHarness( onFinish );\n*\n* function onFinish() {\n*     bench.close();\n*     console.log( 'Exit code: %d', bench.exitCode );\n* }\n*\n* bench( 'beep', function benchmark( b ) {\n*     var x;\n*     var i;\n*     b.tic();\n*     for ( i = 0; i < b.iterations; i++ ) {\n*         x = Math.sin( Math.random() );\n*         if ( x !== x ) {\n*             b.ok( false, 'should not return NaN' );\n*         }\n*     }\n*     b.toc();\n*     if ( x !== x ) {\n*         b.ok( false, 'should not return NaN' );\n*     }\n*     b.end();\n* });\n*\n* @example\n* var stdout = require( '@stdlib/streams-node-stdout' );\n*\n* var stream = createHarness().createStream();\n* stream.pipe( stdout );\n*/\nfunction createHarness( options, clbk ) {\n\tvar exitCode;\n\tvar runner;\n\tvar queue;\n\tvar opts;\n\tvar cb;\n\n\topts = {};\n\tif ( arguments.length === 1 ) {\n\t\tif ( isFunction( options ) ) {\n\t\t\tcb = options;\n\t\t} else if ( isObject( options ) ) {\n\t\t\topts = options;\n\t\t} else {\n\t\t\tthrow new TypeError( format( 'invalid argument. Must provide either an options object or a function. Value: `%s`.', options ) );\n\t\t}\n\t} else if ( arguments.length > 1 ) {\n\t\tif ( !isObject( options ) ) {\n\t\t\tthrow new TypeError( format( '05d3X', options ) );\n\t\t}\n\t\tif ( hasOwnProp( options, 'autoclose' ) ) {\n\t\t\topts.autoclose = options.autoclose;\n\t\t\tif ( !isBoolean( opts.autoclose ) ) {\n\t\t\t\tthrow new TypeError( format( '05d30', 'autoclose', opts.autoclose ) );\n\t\t\t}\n\t\t}\n\t\tcb = clbk;\n\t\tif ( !isFunction( cb ) ) {\n\t\t\tthrow new TypeError( format( '05d2S', cb ) );\n\t\t}\n\t}\n\trunner = new Runner();\n\tif ( opts.autoclose ) {\n\t\trunner.once( 'done', close );\n\t}\n\tif ( cb ) {\n\t\trunner.once( 'done', cb );\n\t}\n\texitCode = 0;\n\tqueue = [];\n\n\t/**\n\t* Benchmark harness.\n\t*\n\t* @private\n\t* @param {string} name - benchmark name\n\t* @param {Options} [options] - benchmark options\n\t* @param {boolean} [options.skip=false] - boolean indicating whether to skip a benchmark\n\t* @param {(PositiveInteger|null)} [options.iterations=null] - number of iterations\n\t* @param {PositiveInteger} [options.repeats=3] - number of repeats\n\t* @param {PositiveInteger} [options.timeout=300000] - number of milliseconds before a benchmark automatically fails\n\t* @param {Function} [benchmark] - function containing benchmark code\n\t* @throws {TypeError} first argument must be a string\n\t* @throws {TypeError} options argument must be an object\n\t* @throws {TypeError} must provide valid options\n\t* @throws {TypeError} benchmark argument must a function\n\t* @throws {Error} benchmark error\n\t* @returns {Function} benchmark harness\n\t*/\n\tfunction harness( name, options, benchmark ) {\n\t\tvar opts;\n\t\tvar err;\n\t\tvar b;\n\t\tif ( !isString( name ) ) {\n\t\t\tthrow new TypeError( format( '05d3R', name ) );\n\t\t}\n\t\topts = copy( DEFAULTS );\n\t\tif ( arguments.length === 2 ) {\n\t\t\tif ( isFunction( options ) ) {\n\t\t\t\tb = options;\n\t\t\t} else {\n\t\t\t\terr = validate( opts, options );\n\t\t\t\tif ( err ) {\n\t\t\t\t\tthrow err;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ( arguments.length > 2 ) {\n\t\t\terr = validate( opts, options );\n\t\t\tif ( err ) {\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t\tb = benchmark;\n\t\t\tif ( !isFunction( b ) ) {\n\t\t\t\tthrow new TypeError( format( '05d3Z', b ) );\n\t\t\t}\n\t\t}\n\t\t// Add the benchmark to the initialization queue:\n\t\tqueue.push( [ name, opts, b ] );\n\n\t\t// Perform initialization on the next turn of the event loop (note: this allows all benchmarks to be \"registered\" within the same turn of the loop; otherwise, we run the risk of registration-execution race conditions (i.e., a benchmark registers and executes before other benchmarks can register, depleting the benchmark queue and leading the harness to close)):\n\t\tif ( queue.length === 1 ) {\n\t\t\tnextTick( initialize );\n\t\t}\n\t\treturn harness;\n\t}\n\n\t/**\n\t* Initializes each benchmark.\n\t*\n\t* @private\n\t* @returns {void}\n\t*/\n\tfunction initialize() {\n\t\tvar idx = -1;\n\t\treturn next();\n\n\t\t/**\n\t\t* Initialize the next benchmark.\n\t\t*\n\t\t* @private\n\t\t* @returns {void}\n\t\t*/\n\t\tfunction next() {\n\t\t\tvar args;\n\n\t\t\tidx += 1;\n\n\t\t\t// If all benchmarks have been initialized, begin running the benchmarks:\n\t\t\tif ( idx === queue.length ) {\n\t\t\t\tqueue.length = 0;\n\t\t\t\treturn runner.run();\n\t\t\t}\n\t\t\t// Initialize the next benchmark:\n\t\t\targs = queue[ idx ];\n\t\t\tinit( args[ 0 ], args[ 1 ], args[ 2 ], onInit );\n\t\t}\n\n\t\t/**\n\t\t* Callback invoked after performing initialization tasks.\n\t\t*\n\t\t* @private\n\t\t* @param {string} name - benchmark name\n\t\t* @param {Options} opts - benchmark options\n\t\t* @param {(Function|undefined)} benchmark - function containing benchmark code\n\t\t* @returns {void}\n\t\t*/\n\t\tfunction onInit( name, opts, benchmark ) {\n\t\t\tvar b;\n\t\t\tvar i;\n\n\t\t\t// Create a `Benchmark` instance for each repeat to ensure each benchmark has its own state...\n\t\t\tfor ( i = 0; i < opts.repeats; i++ ) {\n\t\t\t\tb = new Benchmark( name, opts, benchmark );\n\t\t\t\tb.on( 'result', onResult );\n\t\t\t\trunner.push( b );\n\t\t\t}\n\t\t\treturn next();\n\t\t}\n\t}\n\n\t/**\n\t* Callback invoked upon a `result` event.\n\t*\n\t* @private\n\t* @param {(string|Object)} result - result\n\t*/\n\tfunction onResult( result ) {\n\t\tif (\n\t\t\t!isString( result ) &&\n\t\t\t!result.ok &&\n\t\t\t!result.todo\n\t\t) {\n\t\t\texitCode = 1;\n\t\t}\n\t}\n\n\t/**\n\t* Returns a results stream.\n\t*\n\t* @private\n\t* @param {Object} [options] - options\n\t* @returns {TransformStream} transform stream\n\t*/\n\tfunction createStream( options ) {\n\t\tif ( arguments.length ) {\n\t\t\treturn runner.createStream( options );\n\t\t}\n\t\treturn runner.createStream();\n\t}\n\n\t/**\n\t* Closes a benchmark harness.\n\t*\n\t* @private\n\t*/\n\tfunction close() {\n\t\trunner.close();\n\t}\n\n\t/**\n\t* Forcefully exits a benchmark harness.\n\t*\n\t* @private\n\t*/\n\tfunction exit() {\n\t\trunner.exit();\n\t}\n\n\t/**\n\t* Returns the harness exit code.\n\t*\n\t* @private\n\t* @returns {NonNegativeInteger} exit code\n\t*/\n\tfunction getExitCode() {\n\t\treturn exitCode;\n\t}\n\n\tsetReadOnly( harness, 'createStream', createStream );\n\tsetReadOnly( harness, 'close', close );\n\tsetReadOnly( harness, 'exit', exit );\n\tsetReadOnlyAccessor( harness, 'exitCode', getExitCode );\n\n\treturn harness;\n}\n\n\n// EXPORTS //\n\nmodule.exports = createHarness;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar proc = require( 'process' );\n\n\n// EXPORTS //\n\nmodule.exports = proc;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar proc = require( './process.js' );\n\n\n// MAIN //\n\nvar bool = ( proc && typeof proc.exit === 'function' );\n\n\n// EXPORTS //\n\nmodule.exports = bool;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar IS_BROWSER = require( '@stdlib/assert-is-browser' );\nvar canExit = require( './can_exit.js' );\n\n\n// MAIN //\n\nvar bool = ( !IS_BROWSER && canExit );\n\n\n// EXPORTS //\n\nmodule.exports = bool;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Writes a string to the console.\n*\n* @private\n* @param {string} str - string to write\n*/\nfunction log( str ) {\n\tconsole.log( str ); // eslint-disable-line no-console\n}\n\n\n// EXPORTS //\n\nmodule.exports = log;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar TransformStream = require( '@stdlib/streams-node-transform' );\nvar fromCodePoint = require( '@stdlib/string-from-code-point' );\nvar log = require( './log.js' );\n\n\n// MAIN //\n\n/**\n* Returns a Transform stream for logging to the console.\n*\n* @private\n* @returns {TransformStream} transform stream\n*/\nfunction createStream() {\n\tvar stream;\n\tvar line;\n\n\tstream = new TransformStream({\n\t\t'transform': transform,\n\t\t'flush': flush\n\t});\n\tline = '';\n\n\treturn stream;\n\n\t/**\n\t* Callback invoked upon receiving a new chunk.\n\t*\n\t* @private\n\t* @param {(Buffer|string)} chunk - chunk\n\t* @param {string} enc - Buffer encoding\n\t* @param {Callback} clbk - callback to invoke after transforming the streamed chunk\n\t*/\n\tfunction transform( chunk, enc, clbk ) {\n\t\tvar c;\n\t\tvar i;\n\n\t\tfor ( i = 0; i < chunk.length; i++ ) {\n\t\t\tc = fromCodePoint( chunk[ i ] );\n\t\t\tif ( c === '\\n' ) {\n\t\t\t\tflush();\n\t\t\t} else {\n\t\t\t\tline += c;\n\t\t\t}\n\t\t}\n\t\tclbk();\n\t}\n\n\t/**\n\t* Callback to flush data to `stdout`.\n\t*\n\t* @private\n\t* @param {Callback} [clbk] - callback to invoke after processing data\n\t* @returns {void}\n\t*/\n\tfunction flush( clbk ) {\n\t\ttry {\n\t\t\tlog( line );\n\t\t} catch ( err ) {\n\t\t\tstream.emit( 'error', err );\n\t\t}\n\t\tline = '';\n\t\tif ( clbk ) {\n\t\t\treturn clbk();\n\t\t}\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = createStream;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar isFunction = require( '@stdlib/assert-is-function' );\nvar isBoolean = require( '@stdlib/assert-is-boolean' ).isPrimitive;\nvar isObject = require( '@stdlib/assert-is-plain-object' );\nvar isNodeWritableStreamLike = require( '@stdlib/assert-is-node-writable-stream-like' );\nvar hasOwnProp = require( '@stdlib/assert-has-own-property' );\nvar format = require( '@stdlib/error-tools-fmtprodmsg' );\nvar pick = require( '@stdlib/utils-pick' );\nvar omit = require( '@stdlib/utils-omit' );\nvar noop = require( '@stdlib/utils-noop' );\nvar createHarness = require( './harness' );\nvar logStream = require( './log' );\nvar canEmitExit = require( './utils/can_emit_exit.js' );\nvar proc = require( './utils/process.js' );\n\n\n// MAIN //\n\n/**\n* Creates a benchmark harness which supports closing when a process exits.\n*\n* @private\n* @param {Options} [options] - function options\n* @param {boolean} [options.autoclose] - boolean indicating whether to automatically close a harness after a harness finishes running all benchmarks\n* @param {Stream} [options.stream] - output writable stream\n* @param {Callback} [clbk] - callback to invoke when a harness finishes running all benchmarks\n* @throws {TypeError} options argument must be an object\n* @throws {TypeError} must provide valid options\n* @throws {TypeError} callback argument must be a function\n* @returns {Function} benchmark harness\n*\n* @example\n* var proc = require( 'process' );\n* var bench = createExitHarness( onFinish );\n*\n* function onFinish() {\n*     bench.close();\n* }\n*\n* bench( 'beep', function benchmark( b ) {\n*     var x;\n*     var i;\n*     b.tic();\n*     for ( i = 0; i < b.iterations; i++ ) {\n*         x = Math.sin( Math.random() );\n*         if ( x !== x ) {\n*             b.ok( false, 'should not return NaN' );\n*         }\n*     }\n*     b.toc();\n*     if ( x !== x ) {\n*         b.ok( false, 'should not return NaN' );\n*     }\n*     b.end();\n* });\n*\n* @example\n* var stdout = require( '@stdlib/streams-node-stdout' );\n*\n* var stream = createExitHarness().createStream();\n* stream.pipe( stdout );\n*/\nfunction createExitHarness() {\n\tvar exitCode;\n\tvar pipeline;\n\tvar harness;\n\tvar options;\n\tvar stream;\n\tvar topts;\n\tvar opts;\n\tvar clbk;\n\n\tif ( arguments.length === 0 ) {\n\t\toptions = {};\n\t\tclbk = noop;\n\t} else if ( arguments.length === 1 ) {\n\t\tif ( isFunction( arguments[ 0 ] ) ) {\n\t\t\toptions = {};\n\t\t\tclbk = arguments[ 0 ];\n\t\t} else if ( isObject( arguments[ 0 ] ) ) {\n\t\t\toptions = arguments[ 0 ];\n\t\t\tclbk = noop;\n\t\t} else {\n\t\t\tthrow new TypeError( format( 'invalid argument. Must provide either an options object or a function. Value: `%s`.', arguments[ 0 ] ) );\n\t\t}\n\t} else {\n\t\toptions = arguments[ 0 ];\n\t\tif ( !isObject( options ) ) {\n\t\t\tthrow new TypeError( format( '05d3X', options ) );\n\t\t}\n\t\tclbk = arguments[ 1 ];\n\t\tif ( !isFunction( clbk ) ) {\n\t\t\tthrow new TypeError( format( '05d2S', clbk ) );\n\t\t}\n\t}\n\topts = {};\n\tif ( hasOwnProp( options, 'autoclose' ) ) {\n\t\topts.autoclose = options.autoclose;\n\t\tif ( !isBoolean( opts.autoclose ) ) {\n\t\t\tthrow new TypeError( format( '05d30', 'autoclose', opts.autoclose ) );\n\t\t}\n\t}\n\tif ( hasOwnProp( options, 'stream' ) ) {\n\t\topts.stream = options.stream;\n\t\tif ( !isNodeWritableStreamLike( opts.stream ) ) {\n\t\t\tthrow new TypeError( format( '05d3Y', 'stream', opts.stream ) );\n\t\t}\n\t}\n\texitCode = 0;\n\n\t// Create a new harness:\n\ttopts = pick( opts, [ 'autoclose' ] );\n\tharness = createHarness( topts, done );\n\n\t// Create a results stream:\n\ttopts = omit( options, [ 'autoclose', 'stream' ] );\n\tstream = harness.createStream( topts );\n\n\t// Pipe results to an output stream:\n\tpipeline = stream.pipe( opts.stream || logStream() );\n\n\t// If a process can emit an 'exit' event, capture errors in order to set the exit code...\n\tif ( canEmitExit ) {\n\t\tpipeline.on( 'error', onError );\n\t\tproc.on( 'exit', onExit );\n\t}\n\treturn harness;\n\n\t/**\n\t* Callback invoked when a harness finishes.\n\t*\n\t* @private\n\t* @returns {void}\n\t*/\n\tfunction done() {\n\t\treturn clbk();\n\t}\n\n\t/**\n\t* Callback invoked upon a stream `error` event.\n\t*\n\t* @private\n\t* @param {Error} error - error object\n\t*/\n\tfunction onError() {\n\t\texitCode = 1;\n\t}\n\n\t/**\n\t* Callback invoked upon an `exit` event.\n\t*\n\t* @private\n\t* @param {integer} code - exit code\n\t*/\n\tfunction onExit( code ) {\n\t\tif ( code !== 0 ) {\n\t\t\t// Allow the process to exit...\n\t\t\treturn;\n\t\t}\n\t\tharness.close();\n\t\tproc.exit( exitCode || harness.exitCode );\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = createExitHarness;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar canEmitExit = require( './utils/can_emit_exit.js' );\nvar createExitHarness = require( './exit_harness.js' );\n\n\n// VARIABLES //\n\nvar harness;\n\n\n// MAIN //\n\n/**\n* Returns a benchmark harness. If a harness has already been created, returns the cached harness.\n*\n* @private\n* @param {Options} [options] - harness options\n* @param {Callback} [clbk] - callback to invoke when a harness finishes running all benchmarks\n* @returns {Function} benchmark harness\n*/\nfunction getHarness( options, clbk ) {\n\tvar opts;\n\tvar cb;\n\tif ( harness ) {\n\t\treturn harness;\n\t}\n\tif ( arguments.length > 1 ) {\n\t\topts = options;\n\t\tcb = clbk;\n\t} else {\n\t\topts = {};\n\t\tcb = options;\n\t}\n\topts.autoclose = !canEmitExit;\n\tharness = createExitHarness( opts, cb );\n\n\t// Update state:\n\tgetHarness.cached = true;\n\n\treturn harness;\n}\n\n\n// EXPORTS //\n\nmodule.exports = getHarness;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar TransformStream = require( '@stdlib/streams-node-transform' );\nvar setReadOnly = require( '@stdlib/utils-define-nonenumerable-read-only-property' );\nvar isFunction = require( '@stdlib/assert-is-function' );\nvar format = require( '@stdlib/error-tools-fmtprodmsg' );\nvar createHarness = require( './harness' );\nvar harness = require( './get_harness.js' );\n\n\n// VARIABLES //\n\nvar listeners = [];\n\n\n// FUNCTIONS //\n\n/**\n* Callback invoked when a harness finishes running all benchmarks.\n*\n* @private\n*/\nfunction done() {\n\tvar len;\n\tvar f;\n\tvar i;\n\n\tlen = listeners.length;\n\n\t// Inform all the listeners that the harness has finished...\n\tfor ( i = 0; i < len; i++ ) {\n\t\tf = listeners.shift();\n\t\tf();\n\t}\n}\n\n/**\n* Creates a results stream.\n*\n* @private\n* @param {Options} [options] - stream options\n* @throws {Error} must provide valid stream options\n* @returns {TransformStream} results stream\n*/\nfunction createStream( options ) {\n\tvar stream;\n\tvar bench;\n\tvar opts;\n\tif ( arguments.length ) {\n\t\topts = options;\n\t} else {\n\t\topts = {};\n\t}\n\t// If we have already created a harness, calling this function simply creates another results stream...\n\tif ( harness.cached ) {\n\t\tbench = harness();\n\t\treturn bench.createStream( opts );\n\t}\n\tstream = new TransformStream( opts );\n\topts.stream = stream;\n\n\t// Create a harness which uses the created output stream:\n\tharness( opts, done );\n\n\treturn stream;\n}\n\n/**\n* Adds a listener for when a harness finishes running all benchmarks.\n*\n* @private\n* @param {Callback} clbk - listener\n* @throws {TypeError} must provide a function\n* @throws {Error} must provide a listener only once\n* @returns {void}\n*/\nfunction onFinish( clbk ) {\n\tvar i;\n\tif ( !isFunction( clbk ) ) {\n\t\tthrow new TypeError( format( '05d3V', clbk ) );\n\t}\n\t// Allow adding a listener only once...\n\tfor ( i = 0; i < listeners.length; i++ ) {\n\t\tif ( clbk === listeners[ i ] ) {\n\t\t\tthrow new Error( format( '05d0B' ) );\n\t\t}\n\t}\n\tlisteners.push( clbk );\n}\n\n\n// MAIN //\n\n/**\n* Runs a benchmark.\n*\n* @param {string} name - benchmark name\n* @param {Options} [options] - benchmark options\n* @param {boolean} [options.skip=false] - boolean indicating whether to skip a benchmark\n* @param {(PositiveInteger|null)} [options.iterations=null] - number of iterations\n* @param {PositiveInteger} [options.repeats=3] - number of repeats\n* @param {PositiveInteger} [options.timeout=300000] - number of milliseconds before a benchmark automatically fails\n* @param {Function} [benchmark] - function containing benchmark code\n* @throws {TypeError} first argument must be a string\n* @throws {TypeError} options argument must be an object\n* @throws {TypeError} must provide valid options\n* @throws {TypeError} benchmark argument must a function\n* @returns {Benchmark} benchmark harness\n*\n* @example\n* bench( 'beep', function benchmark( b ) {\n*     var x;\n*     var i;\n*     b.tic();\n*     for ( i = 0; i < b.iterations; i++ ) {\n*         x = Math.sin( Math.random() );\n*         if ( x !== x ) {\n*             b.ok( false, 'should not return NaN' );\n*         }\n*     }\n*     b.toc();\n*     if ( x !== x ) {\n*         b.ok( false, 'should not return NaN' );\n*     }\n*     b.end();\n* });\n*/\nfunction bench( name, options, benchmark ) {\n\tvar h = harness( done );\n\tif ( arguments.length < 2 ) {\n\t\th( name );\n\t} else if ( arguments.length === 2 ) {\n\t\th( name, options );\n\t} else {\n\t\th( name, options, benchmark );\n\t}\n\treturn bench;\n}\n\n/**\n* Creates a benchmark harness.\n*\n* @name createHarness\n* @memberof bench\n* @type {Function}\n* @param {Options} [options] - harness options\n* @param {Callback} [clbk] - callback to invoke when a harness finishes running all benchmarks\n* @throws {TypeError} options argument must be an object\n* @throws {TypeError} must provide valid options\n* @throws {TypeError} callback argument must be a function\n* @returns {Function} benchmark harness\n*/\nsetReadOnly( bench, 'createHarness', createHarness );\n\n/**\n* Creates a results stream.\n*\n* @name createStream\n* @memberof bench\n* @type {Function}\n* @param {Options} [options] - stream options\n* @throws {Error} must provide valid stream options\n* @returns {TransformStream} results stream\n*/\nsetReadOnly( bench, 'createStream', createStream );\n\n/**\n* Adds a listener for when a harness finishes running all benchmarks.\n*\n* @name onFinish\n* @memberof bench\n* @type {Function}\n* @param {Callback} clbk - listener\n* @throws {TypeError} must provide a function\n* @throws {Error} must provide a listener only once\n* @returns {void}\n*/\nsetReadOnly( bench, 'onFinish', onFinish );\n\n\n// EXPORTS //\n\nmodule.exports = bench;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n/**\n* Benchmark harness.\n*\n* @module @stdlib/bench-harness\n*\n* @example\n* var bench = require( '@stdlib/bench-harness' );\n*\n* bench( 'beep', function benchmark( b ) {\n*     var x;\n*     var i;\n*     b.tic();\n*     for ( i = 0; i < b.iterations; i++ ) {\n*         x = Math.sin( Math.random() );\n*         if ( x !== x ) {\n*             b.ok( false, 'should not return NaN' );\n*         }\n*     }\n*     b.toc();\n*     if ( x !== x ) {\n*         b.ok( false, 'should not return NaN' );\n*     }\n*     b.end();\n* });\n*/\n\n// MODULES //\n\nvar bench = require( './bench.js' );\n\n\n// EXPORTS //\n\nmodule.exports = bench;\n"],"names":["set_timeout","setTimeout","clear_timeout","clearTimeout","timeout","require$$0","clear","require$$1","run_1","self","id","this","_skip","comment","name","end","_benchmark","_running","fail","once","emit","exit_1","_exited","_ended","ended_1","format","hasOwnProp","assert_1","ok","opts","result","_count","skip","todo","message","operator","actual","expected","error","Error","trim","replace","EOL","require$$2","REGEXP","RE_COMMENT","comment_1","msg","lines","i","split","length","skip_1","value","_assert","todo_1","fail_1","pass_1","ok_1","not_ok","equal_1","not_equal","deep_equal","not_deep_equal","next_tick","fcn","nextTick","end_1","EventEmitter","defineProperty","setReadOnly","require$$3","tic","require$$4","toc","require$$5","run","require$$6","exit","require$$7","ended","require$$8","assert","require$$9","require$$10","require$$11","require$$12","require$$13","pass","require$$14","require$$15","notOk","require$$16","equal","require$$17","notEqual","require$$18","deepEqual","require$$19","notDeepEqual","require$$20","require$$21","Benchmark","benchmark","hasTicked","hasTocked","time","call","configurable","enumerable","writable","elapsed","secs","rate","out","iterations","prototype","benchmarkClass","RE_EOL","RE_WHITESPACE","encode_assertion","count","actualStack","errorStack","stack","toString","indent","at","encode_result","YAML_INDENT","isString","isPrimitive","encodeAssertion","encodeResult","push_1","b","_benchmarks","push","_stream","write","on","res","total","TransformStream","create_stream","options","stream","arguments","objectMode","onPush","onDone","TAP_HEADER","pipe","onRun","next","onTick","shift","bid","row","type","destroy","clear_1","close","_closed","createStream","Runner","runner","isObject","isBoolean","isNull","isPositiveInteger","validate_1","TypeError","repeats","copy","pretest_1","clbk","err","pretest","onResult","onEnd","init_1","onIterations","iter","setReadOnlyAccessor","isFunction","DEFAULTS","validate","init","harness","exitCode","queue","cb","autoclose","initialize","idx","args","onInit","getExitCode","process","bool","can_emit_exit","fromCodePoint","log","str","console","log_1","line","transform","chunk","enc","c","flush","isNodeWritableStreamLike","pick","omit","noop","createHarness","logStream","canEmitExit","proc","exit_harness","pipeline","topts","done","onError","onExit","code","createExitHarness","get_harness","getHarness","cached","listeners","len","f","bench","h","lib"],"mappings":"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"}